## wasm rev for begginers

webassembly(wasm)에 관한 문제이다.

![initial](https://github.com/user-attachments/assets/05d7cdfe-9139-4027-a0f5-e486063a7154)

이런 파일들과 html 파일 하나가 들어있었다.

![image](https://github.com/user-attachments/assets/1d9c1c29-b3af-4c9a-9d1f-09992ca01c1e)

해당 사이트의 모습은 위와 같다.

.d.ts 파일은 처음 봐서, 구글링을 해주었더니 해당 파일은 type을 정의(declare)하기 위해 존재하는 파일이라고 한다.

.d.ts 파일은 기존 JavaScript로 만들어진 서드파티 모듈들은 TypeScript 환경에서도 사용할 수 있도록 따로 타입만 정리해서 넣어둔 파일이다.

그렇다면 우선 challenge_bg.wasm.d.ts 파일을 vscode로 열어보겠다.

<pre><code>
  /* tslint:disable */
/* eslint-disable */
export const memory: WebAssembly.Memory;
export function check(a: number, b: number): void;
export function __wbindgen_malloc(a: number, b: number): number;
export function __wbindgen_realloc(a: number, b: number, c: number, d: number): number;
</code></pre>

그리고 아래의 코드는 challenge.d.ts의 파일을 vscode로 열어본 모습이다.

<pre><code>
  /* tslint:disable */
/* eslint-disable */
/**
* @param {string} flag
*/
export function check(flag: string): void;

export type InitInput = RequestInfo | URL | Response | BufferSource | WebAssembly.Module;

export interface InitOutput {
  readonly memory: WebAssembly.Memory;
  readonly check: (a: number, b: number) => void;
  readonly __wbindgen_malloc: (a: number, b: number) => number;
  readonly __wbindgen_realloc: (a: number, b: number, c: number, d: number) => number;
}

export type SyncInitInput = BufferSource | WebAssembly.Module;
/**
* Instantiates the given `module`, which can either be bytes or
* a precompiled `WebAssembly.Module`.
*
* @param {SyncInitInput} module
*
* @returns {InitOutput}
*/
export function initSync(module: SyncInitInput): InitOutput;

/**
* If `module_or_path` is {RequestInfo} or {URL}, makes a request and
* for everything else, calls `WebAssembly.instantiate` directly.
*
* @param {InitInput | Promise<InitInput>} module_or_path
*
* @returns {Promise<InitOutput>}
*/
export default function __wbg_init (module_or_path?: InitInput | Promise<InitInput>): Promise<InitOutput>;
</code></pre>

구글링 하니까 일단 wasm 파일을 wat 파일로 바꿔보는 사람이 많아서 나도 그렇게 해보도록 하겠다.

그러기 위해서는 우선 wabt를 설치해야 한다.

![initial](https://github.com/user-attachments/assets/a7f16431-c6ed-4d6b-b4c2-e332f7ae2ad9)

이렇게 설치까지 해줬다.

이와 관련해서는 이 링크를 참고하였다. (https://cluberwsoh9812.tistory.com/17)

![initial](https://github.com/user-attachments/assets/e72cd857-6ee3-4205-9370-5b619964ea8a)

뭔가 wat 파일로 변환을 해줘도 바뀌는 게... 없다.

C언어로 디컴파일 해야 하는 건가 싶어서 시도해본다.

![initial](https://github.com/user-attachments/assets/967e429c-7bcd-4bf6-85c2-7fde9a031ec8)

이렇게 보이는 것과 같이 C 파일로 디컴파일한 모습이다.

![initial](https://github.com/user-attachments/assets/c1f3bd1d-7ace-4028-908c-99a201031b64)

이런 식으로 C 파일로 변환하여 코드를 살펴보았다.

사실 여기서 뭘 더 어떻게 해야 할지 모르겠어서, wasm과 관련하여 다른 문제를 푼 사람들의 라업을 조금 살펴보니까

이를 shared object file로 변환하는 사람들이 많아서 한 번 시도해 보도록 하겠다.

so 파일로 변환하기 위해선 일단 gcc를 통해 컴파일 해야 한다.

![initial](https://github.com/user-attachments/assets/cba6ae2e-c73e-4e29-bf9d-3e2171a0b0bd)

이렇게 위의 사진에 보이는 것과 같이 so 파일까지 완성한다.

![initial](https://github.com/user-attachments/assets/20251af4-a906-48f2-8994-9843073abe25)

근데 so 파일이 이렇게 뜨는 걸 봐서, 아마 ida같은 툴로 열어봐야 할 것 같다.

![initial](https://github.com/user-attachments/assets/0e2d743e-160e-45ed-b73f-199f33923e5f)

이 해당 so 파일을 ida로 디컴파일해서 보았을 때, 하나하나 다 보긴 조금 그렇고 check라고 되어있는 부분들 위주로 보았다.

(뭔가 f[숫자]의 형태들은 뭔가 별거 없을 것 같아서 건너뜀)

그러니까 조금 길게 코드가 있는 부분이 눈에 들어왔는데... 음.... 조금 복잡하게 보인다.

<pre><code>
  __int64 __fastcall w2c_challenge__bg_check_0(_QWORD *a1, unsigned int a2, unsigned int a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  __int64 result; // rax
  int v11; // [rsp+1Ch] [rbp-24h]
  int v12; // [rsp+1Ch] [rbp-24h]
  int i; // [rsp+1Ch] [rbp-24h]
  int v14; // [rsp+20h] [rbp-20h]
  int v15; // [rsp+24h] [rbp-1Ch]
  unsigned int v16; // [rsp+24h] [rbp-1Ch]
  unsigned int v17; // [rsp+28h] [rbp-18h]
  unsigned int v18; // [rsp+30h] [rbp-10h]
  unsigned int v19; // [rsp+34h] [rbp-Ch]
  unsigned int v20; // [rsp+34h] [rbp-Ch]
  int v21; // [rsp+34h] [rbp-Ch]
  int v22; // [rsp+34h] [rbp-Ch]
  int v23; // [rsp+38h] [rbp-8h]

  v11 = 0;
  if ( a3 == 68 )
  {
    i32_load8_u(a1 + 2, 1049325LL);
    v18 = w2c_challenge__bg_f36((__int64)a1, 0x44u, 1u);
    if ( v18 )
    {
      do
      {
        v19 = i32_load8_u(a1 + 2, (unsigned int)(v11 + 0x100000));
        v3 = i32_load8_u(a1 + 2, v11 + a2);
        i32_store8(a1 + 2, v18 + v11, v3 ^ v19);
        v20 = i32_load8_u(a1 + 2, (unsigned int)(v11 + 0x100001));
        v23 = i32_load8_u(a1 + 2, v11 + a2 + 1);
        i32_store8(a1 + 2, v18 + v11 + 1, v23 ^ v20);
        v11 += 2;
      }
      while ( v11 != 68 );
      i32_load8_u(a1 + 2, 1049325LL);
      v17 = w2c_challenge__bg_f36((__int64)a1, 0x44u, 1u);
      if ( v17 )
      {
        v12 = -68;
        do
        {
          v4 = i32_load8_u(a1 + 2, v18 + v12 + 68);
          i32_store8(a1 + 2, v17 + v12 + 68, (unsigned int)(13 * v4 + 37));
          v5 = i32_load8_u(a1 + 2, v18 + v12 + 69);
          i32_store8(a1 + 2, v17 + v12 + 69, (unsigned int)(13 * v5 + 37));
          v6 = i32_load8_u(a1 + 2, v18 + v12 + 70);
          i32_store8(a1 + 2, v17 + v12 + 70, (unsigned int)(13 * v6 + 37));
          v7 = i32_load8_u(a1 + 2, v18 + v12 + 71);
          i32_store8(a1 + 2, v17 + v12 + 71, (unsigned int)(13 * v7 + 37));
          v12 += 4;
        }
        while ( v12 );
        v14 = 0;
        for ( i = 0; i != 68; i += 2 )
        {
          v21 = i32_load8_u(a1 + 2, v17 + i);
          v15 = (v21 == (unsigned int)i32_load8_u(a1 + 2, (unsigned int)(i + 1048644))) + v14;
          v22 = i32_load8_u(a1 + 2, v17 + i + 1);
          v14 = (v22 == (unsigned int)i32_load8_u(a1 + 2, (unsigned int)(i + 1048645))) + v15;
        }
        w2c_challenge__bg_f2(a1, v17);
        w2c_challenge__bg_f2(a1, v18);
        if ( v14 == 68 )
          v8 = 0x100090;
        else
          v8 = 0x100088;
        v16 = v8;
        goto LABEL_14;
      }
    }
    else
    {
      w2c_challenge__bg_f53((__int64)a1, 1u, 0x44u);
      wasm_rt_trap(5LL);
    }
    w2c_challenge__bg_f53((__int64)a1, 1u, 0x44u);
    return wasm_rt_trap(5LL);
  }
  v16 = 1048712;
LABEL_14:
  w2c_wbg_0x5F_wbg_alert_9606c3146601d524(*a1, v16, 8LL);
  result = a3;
  if ( a3 )
    return w2c_challenge__bg_f2(a1, a2);
  return result;
}
</code></pre>

우선 해당 코드를 가져와봤다.

세세하게 분석하는 건 아니지만 간단히 보면... a2와 a3을 입력받고, a3 == 68이라면 뭘 수행하고,

그렇지 않으면 w2c_wbg_0x5F_wbg_alert_9606c3146601d524 호출, a3은 추가처리 부분이다.

만약 a3 == 68이라면 w2c_challenge__bg_f36 호출, 해당 값이 존재하면 XOR 연산 후 다른 메모리 위치에 또 저장하는 방식인 것 같다.

또 반복문을 통해 특정값을 계산하여 저장하는데 주요 기능을 더 살펴보자면 

메모리 저장, XOR 연산, 함수 호출, 조건 비교 등인 것 같다.

c 파일을 다시 봐야 할 것 같은데…

음…

![initial](https://github.com/user-attachments/assets/0b0e9022-4d90-4c73-ae19-91701d614c45)

C 파일을 보면 이렇게 수많은 헥스값들이 적혀있는데, 아마 이 값들을 사용해서 코드를 짠 후 (아마?) 플래그를 얻는 것 같다.

<pre><code>
  0x1f, 0xcd, 0x88, 0x9d, 0xbb, 0x2b, 0x56, 0x50, 0xe6, 0x7b, 0xf6, 0x91, 
  0x82, 0x82, 0x7c, 0x25, 0x19, 0xa0, 0x92, 0x9a, 0x74, 0x6e, 0x96, 0xe3, 
  0x67, 0x23, 0x0b, 0xb8, 0x01, 0xa9, 0x33, 0x7d, 0x6d, 0xea, 0x42, 0xcd, 
  0x1a, 0x20, 0xab, 0xe8, 0xe4, 0xa3, 0x27, 0x87, 0x97, 0x0e, 0x06, 0xd6, 
  0x5d, 0x76, 0x4c, 0xa9, 0xe4, 0xd0, 0x99, 0xc7, 0x21, 0x70, 0x35, 0x12, 
  0x36, 0x17, 0xc5, 0xeb, 0xf7, 0xc1, 0x22, 0x90, 0xc4, 0xe6, 0x7c, 0xad, 
  0x5b, 0x1c, 0x2c, 0xe3, 0x6b, 0x0e, 0xf2, 0xb0, 0xd3, 0xb9, 0x01, 0xf5, 
  0x71, 0xff, 0xa3, 0xf1, 0x72, 0xb4, 0x86, 0x03, 0xf8, 0xa6, 0x87, 0x5b, 
  0xfd, 0x8e, 0x4c, 0x5d, 0x9a, 0x34, 0xe2, 0xca, 0x64, 0x36, 0x2b, 0x27, 
  0x10, 0x40, 0x36, 0x15, 0x86, 0xe3, 0xc9, 0x49, 0xc8, 0x65, 0x3a, 0x4d, 
  0x51, 0x22, 0xe1, 0x55, 0x65, 0xcd, 0xc1, 0xec, 0x32, 0xd2, 0xa0, 0x68, 
  0xa9, 0xca, 0xb3, 0x2e, 0x57, 0x72, 0x6f, 0x6e, 0x67, 0x2e, 0x2e, 0x2e, 
  0x43, 0x6f, 0x72, 0x72, 0x65, 0x63, 0x74, 0x21, 0x63, 0x61, 0x6c, 0x6c, 
  0x65, 0x64, 0x20, 0x60, 0x4f, 0x70, 0x74, 0x69, 0x6f, 0x6e, 0x3a, 0x3a, 
  0x75, 0x6e, 0x77, 0x72, 0x61, 0x70, 0x28, 0x29, 0x60, 0x20, 0x6f, 0x6e, 
  0x20, 0x61, 0x20, 0x60, 0x4e, 0x6f, 0x6e, 0x65, 0x60, 0x20, 0x76, 0x61, 
  0x6c, 0x75, 0x65, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 
  0x06, 0x00, 0x00, 0x00, 0x6d, 0x65, 0x6d, 0x6f, 0x72, 0x79, 0x20, 0x61, 
  0x6c, 0x6c, 0x6f, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x6f, 0x66, 
  0x20, 0x20, 0x62, 0x79, 0x74, 0x65, 0x73, 0x20, 0x66, 0x61, 0x69, 0x6c, 
  0x65, 0x64, 0x00, 0x00, 0xdc, 0x00, 0x10, 0x00, 0x15, 0x00, 0x00, 0x00, 
  0xf1, 0x00, 0x10, 0x00, 0x0d, 0x00, 0x00, 0x00, 0x6c, 0x69, 0x62, 0x72, 
  0x61, 0x72, 0x79, 0x2f, 0x73, 0x74, 0x64, 0x2f, 0x73, 0x72, 0x63, 0x2f, 
  0x61, 0x6c, 0x6c, 0x6f, 0x63, 0x2e, 0x72, 0x73, 0x10, 0x01, 0x10, 0x00, 
  0x18, 0x00, 0x00, 0x00, 0x62, 0x01, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 
  0x6c, 0x69, 0x62, 0x72, 0x61, 0x72, 0x79, 0x2f, 0x73, 0x74, 0x64, 0x2f, 
  0x73, 0x72, 0x63, 0x2f, 0x70, 0x61, 0x6e, 0x69, 0x63, 0x6b, 0x69, 0x6e, 
  0x67, 0x2e, 0x72, 0x73, 0x38, 0x01, 0x10, 0x00, 0x1c, 0x00, 0x00, 0x00, 
  0x53, 0x02, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x00, 0x38, 0x01, 0x10, 0x00, 
  0x1c, 0x00, 0x00, 0x00, 0x54, 0x02, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x00, 
  0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 
  0x07, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 
  0x08, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 
  0x0b, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x0d, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 
  0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 
  0x10, 0x00, 0x00, 0x00, 0x6c, 0x69, 0x62, 0x72, 0x61, 0x72, 0x79, 0x2f, 
  0x61, 0x6c, 0x6c, 0x6f, 0x63, 0x2f, 0x73, 0x72, 0x63, 0x2f, 0x72, 0x61, 
  0x77, 0x5f, 0x76, 0x65, 0x63, 0x2e, 0x72, 0x73, 0x63, 0x61, 0x70, 0x61, 
  0x63, 0x69, 0x74, 0x79, 0x20, 0x6f, 0x76, 0x65, 0x72, 0x66, 0x6c, 0x6f, 
  0x77, 0x00, 0x00, 0x00, 0xe8, 0x01, 0x10, 0x00, 0x11, 0x00, 0x00, 0x00, 
  0xcc, 0x01, 0x10, 0x00, 0x1c, 0x00, 0x00, 0x00, 0x16, 0x02, 0x00, 0x00, 
  0x05, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x01, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x30, 0x30, 0x30, 0x31, 
  0x30, 0x32, 0x30, 0x33, 0x30, 0x34, 0x30, 0x35, 0x30, 0x36, 0x30, 0x37, 
  0x30, 0x38, 0x30, 0x39, 0x31, 0x30, 0x31, 0x31, 0x31, 0x32, 0x31, 0x33, 
  0x31, 0x34, 0x31, 0x35, 0x31, 0x36, 0x31, 0x37, 0x31, 0x38, 0x31, 0x39, 
  0x32, 0x30, 0x32, 0x31, 0x32, 0x32, 0x32, 0x33, 0x32, 0x34, 0x32, 0x35, 
  0x32, 0x36, 0x32, 0x37, 0x32, 0x38, 0x32, 0x39, 0x33, 0x30, 0x33, 0x31, 
  0x33, 0x32, 0x33, 0x33, 0x33, 0x34, 0x33, 0x35, 0x33, 0x36, 0x33, 0x37, 
  0x33, 0x38, 0x33, 0x39, 0x34, 0x30, 0x34, 0x31, 0x34, 0x32, 0x34, 0x33, 
  0x34, 0x34, 0x34, 0x35, 0x34, 0x36, 0x34, 0x37, 0x34, 0x38, 0x34, 0x39, 
  0x35, 0x30, 0x35, 0x31, 0x35, 0x32, 0x35, 0x33, 0x35, 0x34, 0x35, 0x35, 
  0x35, 0x36, 0x35, 0x37, 0x35, 0x38, 0x35, 0x39, 0x36, 0x30, 0x36, 0x31, 
  0x36, 0x32, 0x36, 0x33, 0x36, 0x34, 0x36, 0x35, 0x36, 0x36, 0x36, 0x37, 
  0x36, 0x38, 0x36, 0x39, 0x37, 0x30, 0x37, 0x31, 0x37, 0x32, 0x37, 0x33, 
  0x37, 0x34, 0x37, 0x35, 0x37, 0x36, 0x37, 0x37, 0x37, 0x38, 0x37, 0x39, 
  0x38, 0x30, 0x38, 0x31, 0x38, 0x32, 0x38, 0x33, 0x38, 0x34, 0x38, 0x35, 
  0x38, 0x36, 0x38, 0x37, 0x38, 0x38, 0x38, 0x39, 0x39, 0x30, 0x39, 0x31, 
  0x39, 0x32, 0x39, 0x33, 0x39, 0x34, 0x39, 0x35, 0x39, 0x36, 0x39, 0x37, 
  0x39, 0x38, 0x39, 0x39
</code></pre>

한 번 헥스값들을 가져와봤다.

이 헥스값들이 일단 data_segment_dataw2c_challenge__bg_d0 에서 추출한 것들이고, 

음 복호화하는 과정만 진행하면 되는데 아까의 so 파일에서 정확한 연산식을 잘 모르겠어서, gpt를 이용했다.

복호화를 진행하는 역연산은 바이트에서 37을 빼고, 13 * 바이트 + 37의 역연산을 수행한다고 한다.

그리고 13의 모듈러역수를 곱하고 256으로 mod 연산을 수행한다.

그리고 마지막 XOR 과정만 거치면?! 완성된다.

이를 파이썬 코드로 짜보았다.

<pre><code>
  key = [
  0x1f, 0xcd, 0x88, 0x9d, 0xbb, 0x2b, 0x56, 0x50, 0xe6, 0x7b, 0xf6, 0x91, 
  0x82, 0x82, 0x7c, 0x25, 0x19, 0xa0, 0x92, 0x9a, 0x74, 0x6e, 0x96, 0xe3, 
  0x67, 0x23, 0x0b, 0xb8, 0x01, 0xa9, 0x33, 0x7d, 0x6d, 0xea, 0x42, 0xcd, 
  0x1a, 0x20, 0xab, 0xe8, 0xe4, 0xa3, 0x27, 0x87, 0x97, 0x0e, 0x06, 0xd6, 
  0x5d, 0x76, 0x4c, 0xa9, 0xe4, 0xd0, 0x99, 0xc7, 0x21, 0x70, 0x35, 0x12, 
  0x36, 0x17, 0xc5, 0xeb, 0xf7, 0xc1, 0x22, 0x90, 0xc4, 0xe6, 0x7c, 0xad, 
  0x5b, 0x1c, 0x2c, 0xe3, 0x6b, 0x0e, 0xf2, 0xb0, 0xd3, 0xb9, 0x01, 0xf5, 
  0x71, 0xff, 0xa3, 0xf1, 0x72, 0xb4, 0x86, 0x03, 0xf8, 0xa6, 0x87, 0x5b, 
  0xfd, 0x8e, 0x4c, 0x5d, 0x9a, 0x34, 0xe2, 0xca, 0x64, 0x36, 0x2b, 0x27, 
  0x10, 0x40, 0x36, 0x15, 0x86, 0xe3, 0xc9, 0x49, 0xc8, 0x65, 0x3a, 0x4d, 
  0x51, 0x22, 0xe1, 0x55, 0x65, 0xcd, 0xc1, 0xec, 0x32, 0xd2, 0xa0, 0x68, 
  0xa9, 0xca, 0xb3, 0x2e, 0x57, 0x72, 0x6f, 0x6e, 0x67, 0x2e, 0x2e, 0x2e, 
  0x43, 0x6f, 0x72, 0x72, 0x65, 0x63, 0x74, 0x21, 0x63, 0x61, 0x6c, 0x6c, 
  0x65, 0x64, 0x20, 0x60, 0x4f, 0x70, 0x74, 0x69, 0x6f, 0x6e, 0x3a, 0x3a, 
  0x75, 0x6e, 0x77, 0x72, 0x61, 0x70, 0x28, 0x29, 0x60, 0x20, 0x6f, 0x6e, 
  0x20, 0x61, 0x20, 0x60, 0x4e, 0x6f, 0x6e, 0x65, 0x60, 0x20, 0x76, 0x61, 
  0x6c, 0x75, 0x65, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 
  0x06, 0x00, 0x00, 0x00, 0x6d, 0x65, 0x6d, 0x6f, 0x72, 0x79, 0x20, 0x61, 
  0x6c, 0x6c, 0x6f, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x6f, 0x66, 
  0x20, 0x20, 0x62, 0x79, 0x74, 0x65, 0x73, 0x20, 0x66, 0x61, 0x69, 0x6c, 
  0x65, 0x64, 0x00, 0x00, 0xdc, 0x00, 0x10, 0x00, 0x15, 0x00, 0x00, 0x00, 
  0xf1, 0x00, 0x10, 0x00, 0x0d, 0x00, 0x00, 0x00, 0x6c, 0x69, 0x62, 0x72, 
  0x61, 0x72, 0x79, 0x2f, 0x73, 0x74, 0x64, 0x2f, 0x73, 0x72, 0x63, 0x2f, 
  0x61, 0x6c, 0x6c, 0x6f, 0x63, 0x2e, 0x72, 0x73, 0x10, 0x01, 0x10, 0x00, 
  0x18, 0x00, 0x00, 0x00, 0x62, 0x01, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 
  0x6c, 0x69, 0x62, 0x72, 0x61, 0x72, 0x79, 0x2f, 0x73, 0x74, 0x64, 0x2f, 
  0x73, 0x72, 0x63, 0x2f, 0x70, 0x61, 0x6e, 0x69, 0x63, 0x6b, 0x69, 0x6e, 
  0x67, 0x2e, 0x72, 0x73, 0x38, 0x01, 0x10, 0x00, 0x1c, 0x00, 0x00, 0x00, 
  0x53, 0x02, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x00, 0x38, 0x01, 0x10, 0x00, 
  0x1c, 0x00, 0x00, 0x00, 0x54, 0x02, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x00, 
  0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 
  0x07, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 
  0x08, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 
  0x0b, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 
  0x04, 0x00, 0x00, 0x00, 0x0d, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 
  0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 
  0x10, 0x00, 0x00, 0x00, 0x6c, 0x69, 0x62, 0x72, 0x61, 0x72, 0x79, 0x2f, 
  0x61, 0x6c, 0x6c, 0x6f, 0x63, 0x2f, 0x73, 0x72, 0x63, 0x2f, 0x72, 0x61, 
  0x77, 0x5f, 0x76, 0x65, 0x63, 0x2e, 0x72, 0x73, 0x63, 0x61, 0x70, 0x61, 
  0x63, 0x69, 0x74, 0x79, 0x20, 0x6f, 0x76, 0x65, 0x72, 0x66, 0x6c, 0x6f, 
  0x77, 0x00, 0x00, 0x00, 0xe8, 0x01, 0x10, 0x00, 0x11, 0x00, 0x00, 0x00, 
  0xcc, 0x01, 0x10, 0x00, 0x1c, 0x00, 0x00, 0x00, 0x16, 0x02, 0x00, 0x00, 
  0x05, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x01, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x30, 0x30, 0x30, 0x31, 
  0x30, 0x32, 0x30, 0x33, 0x30, 0x34, 0x30, 0x35, 0x30, 0x36, 0x30, 0x37, 
  0x30, 0x38, 0x30, 0x39, 0x31, 0x30, 0x31, 0x31, 0x31, 0x32, 0x31, 0x33, 
  0x31, 0x34, 0x31, 0x35, 0x31, 0x36, 0x31, 0x37, 0x31, 0x38, 0x31, 0x39, 
  0x32, 0x30, 0x32, 0x31, 0x32, 0x32, 0x32, 0x33, 0x32, 0x34, 0x32, 0x35, 
  0x32, 0x36, 0x32, 0x37, 0x32, 0x38, 0x32, 0x39, 0x33, 0x30, 0x33, 0x31, 
  0x33, 0x32, 0x33, 0x33, 0x33, 0x34, 0x33, 0x35, 0x33, 0x36, 0x33, 0x37, 
  0x33, 0x38, 0x33, 0x39, 0x34, 0x30, 0x34, 0x31, 0x34, 0x32, 0x34, 0x33, 
  0x34, 0x34, 0x34, 0x35, 0x34, 0x36, 0x34, 0x37, 0x34, 0x38, 0x34, 0x39, 
  0x35, 0x30, 0x35, 0x31, 0x35, 0x32, 0x35, 0x33, 0x35, 0x34, 0x35, 0x35, 
  0x35, 0x36, 0x35, 0x37, 0x35, 0x38, 0x35, 0x39, 0x36, 0x30, 0x36, 0x31, 
  0x36, 0x32, 0x36, 0x33, 0x36, 0x34, 0x36, 0x35, 0x36, 0x36, 0x36, 0x37, 
  0x36, 0x38, 0x36, 0x39, 0x37, 0x30, 0x37, 0x31, 0x37, 0x32, 0x37, 0x33, 
  0x37, 0x34, 0x37, 0x35, 0x37, 0x36, 0x37, 0x37, 0x37, 0x38, 0x37, 0x39, 
  0x38, 0x30, 0x38, 0x31, 0x38, 0x32, 0x38, 0x33, 0x38, 0x34, 0x38, 0x35, 
  0x38, 0x36, 0x38, 0x37, 0x38, 0x38, 0x38, 0x39, 0x39, 0x30, 0x39, 0x31, 
  0x39, 0x32, 0x39, 0x33, 0x39, 0x34, 0x39, 0x35, 0x39, 0x36, 0x39, 0x37, 
  0x39, 0x38, 0x39, 0x39]

t = key[0x44:0x44 + 68]
a1 = [ (v - 37) * pow(13, -1, 256) % 256 for v in t ]
a2 = [ x ^ y for x, y in zip(a1, key[:68]) ]
print(bytes(a2))
</code></pre>

이렇게 코드를 짜고, 플래그를 얻을 수 있었다.

![initial](https://github.com/user-attachments/assets/795cb8cb-0d5f-4568-82f3-73b99ebe0a8b)

## FLAG: DH{5585f867fdf05ebdf5e358fa69d0eda34a55b3d27282b26ea8a57a89176bdc8d}

![initial](https://github.com/user-attachments/assets/d75e5523-7f30-4f95-9edd-c0f31f1a22db)

(이 문제 하나 풀겠다고 며칠을 매달린 건지 모르것다 Haha)
